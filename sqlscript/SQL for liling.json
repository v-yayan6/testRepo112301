{
	"name": "SQL for liling",
	"properties": {
		"content": {
			"query": "-- type your sql script here, we now have intellisense\nCREATE MASTER KEY;\nGO\n\nCREATE EXTERNAL DATA SOURCE NYTPublic\nWITH\n(\n    TYPE = Hadoop,\n    LOCATION = 'wasbs://2013@nytaxiblob.blob.core.windows.net/'\n);\nGO\n\nCREATE EXTERNAL FILE FORMAT uncompressedcsv\nWITH (\n    FORMAT_TYPE = DELIMITEDTEXT,\n    FORMAT_OPTIONS ( \n        FIELD_TERMINATOR = ',',\n        STRING_DELIMITER = '',\n        DATE_FORMAT = '',\n        USE_TYPE_DEFAULT = False\n    )\n);\nCREATE EXTERNAL FILE FORMAT compressedcsv\nWITH ( \n    FORMAT_TYPE = DELIMITEDTEXT,\n    FORMAT_OPTIONS ( FIELD_TERMINATOR = '|',\n        STRING_DELIMITER = '',\n    DATE_FORMAT = '',\n        USE_TYPE_DEFAULT = False\n    ),\n    DATA_COMPRESSION = 'org.apache.hadoop.io.compress.GzipCodec'\n);\nGO\n\nCREATE SCHEMA ext;\nGO\n\nCREATE EXTERNAL TABLE [ext].[Date] \n(\n    [DateID] int NOT NULL,\n    [Date] datetime NULL,\n    [DateBKey] char(10) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [DayOfMonth] varchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [DaySuffix] varchar(4) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [DayName] varchar(9) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [DayOfWeek] char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [DayOfWeekInMonth] varchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [DayOfWeekInYear] varchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [DayOfQuarter] varchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [DayOfYear] varchar(3) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [WeekOfMonth] varchar(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [WeekOfQuarter] varchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [WeekOfYear] varchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [Month] varchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [MonthName] varchar(9) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [MonthOfQuarter] varchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [Quarter] char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [QuarterName] varchar(9) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [Year] char(4) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [YearName] char(7) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [MonthYear] char(10) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [MMYYYY] char(6) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [FirstDayOfMonth] date NULL,\n    [LastDayOfMonth] date NULL,\n    [FirstDayOfQuarter] date NULL,\n    [LastDayOfQuarter] date NULL,\n    [FirstDayOfYear] date NULL,\n    [LastDayOfYear] date NULL,\n    [IsHolidayUSA] bit NULL,\n    [IsWeekday] bit NULL,\n    [HolidayUSA] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL\n)\nWITH\n(\n    LOCATION = 'Date',\n    DATA_SOURCE = NYTPublic,\n    FILE_FORMAT = uncompressedcsv,\n    REJECT_TYPE = value,\n    REJECT_VALUE = 0\n); \nCREATE EXTERNAL TABLE [ext].[Geography]\n(\n    [GeographyID] int NOT NULL,\n    [ZipCodeBKey] varchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,\n    [County] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [City] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [State] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [Country] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [ZipCode] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL\n)\nWITH\n(\n    LOCATION = 'Geography',\n    DATA_SOURCE = NYTPublic,\n    FILE_FORMAT = uncompressedcsv,\n    REJECT_TYPE = value,\n    REJECT_VALUE = 0 \n);      \nCREATE EXTERNAL TABLE [ext].[HackneyLicense]\n(\n    [HackneyLicenseID] int NOT NULL,\n    [HackneyLicenseBKey] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,\n    [HackneyLicenseCode] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL\n)\nWITH\n(\n    LOCATION = 'HackneyLicense',\n    DATA_SOURCE = NYTPublic,\n    FILE_FORMAT = uncompressedcsv,\n    REJECT_TYPE = value,\n    REJECT_VALUE = 0\n);\nCREATE EXTERNAL TABLE [ext].[Medallion]\n(\n    [MedallionID] int NOT NULL,\n    [MedallionBKey] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,\n    [MedallionCode] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL\n)\nWITH\n(\n    LOCATION = 'Medallion',\n    DATA_SOURCE = NYTPublic,\n    FILE_FORMAT = uncompressedcsv,\n    REJECT_TYPE = value,\n    REJECT_VALUE = 0\n)\n;  \nCREATE EXTERNAL TABLE [ext].[Time]\n(\n    [TimeID] int NOT NULL,\n    [TimeBKey] varchar(8) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,\n    [HourNumber] tinyint NOT NULL,\n    [MinuteNumber] tinyint NOT NULL,\n    [SecondNumber] tinyint NOT NULL,\n    [TimeInSecond] int NOT NULL,\n    [HourlyBucket] varchar(15) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,\n    [DayTimeBucketGroupKey] int NOT NULL,\n    [DayTimeBucket] varchar(100) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL\n)\nWITH\n(\n    LOCATION = 'Time',\n    DATA_SOURCE = NYTPublic,\n    FILE_FORMAT = uncompressedcsv,\n    REJECT_TYPE = value,\n    REJECT_VALUE = 0\n);\nCREATE EXTERNAL TABLE [ext].[Trip]\n(\n    [DateID] int NOT NULL,\n    [MedallionID] int NOT NULL,\n    [HackneyLicenseID] int NOT NULL,\n    [PickupTimeID] int NOT NULL,\n    [DropoffTimeID] int NOT NULL,\n    [PickupGeographyID] int NULL,\n    [DropoffGeographyID] int NULL,\n    [PickupLatitude] float NULL,\n    [PickupLongitude] float NULL,\n    [PickupLatLong] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [DropoffLatitude] float NULL,\n    [DropoffLongitude] float NULL,\n    [DropoffLatLong] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [PassengerCount] int NULL,\n    [TripDurationSeconds] int NULL,\n    [TripDistanceMiles] float NULL,\n    [PaymentType] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,\n    [FareAmount] money NULL,\n    [SurchargeAmount] money NULL,\n    [TaxAmount] money NULL,\n    [TipAmount] money NULL,\n    [TollsAmount] money NULL,\n    [TotalAmount] money NULL\n)\nWITH\n(\n    LOCATION = 'Trip2013',\n    DATA_SOURCE = NYTPublic,\n    FILE_FORMAT = compressedcsv,\n    REJECT_TYPE = value,\n    REJECT_VALUE = 0\n);\nCREATE EXTERNAL TABLE [ext].[Weather]\n(\n    [DateID] int NOT NULL,\n    [GeographyID] int NOT NULL,\n    [PrecipitationInches] float NOT NULL,\n    [AvgTemperatureFahrenheit] float NOT NULL\n)\nWITH\n(\n    LOCATION = 'Weather',\n    DATA_SOURCE = NYTPublic,\n    FILE_FORMAT = uncompressedcsv,\n    REJECT_TYPE = value,\n    REJECT_VALUE = 0\n)\n;\nGO",
			"metadata": {
				"language": "sql"
			}
		}
	}
}